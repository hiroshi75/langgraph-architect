# ファインチューニングワークフロー詳細

LangGraph アプリケーションのファインチューニングを実行する際の詳細なワークフローと実践的なガイドライン。

**💡 Tip**: コピー&ペーストで使える具体的なコード例とテンプレートは [examples.md](examples.md) を参照してください。

## 📋 ワークフロー全体像

```
┌─────────────────────────────────────────────────────────────┐
│ Phase 1: 準備と分析                                           │
├─────────────────────────────────────────────────────────────┤
│ 1. fine-tune.md 読み込み → 目標と評価基準の理解               │
│ 2. Serena で最適化対象の特定 → LLM 呼び出しノードのリスト化   │
│ 3. 最適化箇所リスト作成 → 改善可能性の評価                    │
└─────────────────────────────────────────────────────────────┘
                            ↓
┌─────────────────────────────────────────────────────────────┐
│ Phase 2: ベースライン評価                                     │
├─────────────────────────────────────────────────────────────┤
│ 4. 評価環境準備 → テストケース、評価スクリプト                │
│ 5. ベースライン測定 → 3-5回実行、統計情報収集                 │
│ 6. 結果分析 → 問題点の特定、改善余地の評価                    │
└─────────────────────────────────────────────────────────────┘
                            ↓
┌─────────────────────────────────────────────────────────────┐
│ Phase 3: 反復的改善 (Iteration Loop)                         │
├─────────────────────────────────────────────────────────────┤
│ 7. 優先順位付け → 最も効果的な改善箇所の選択                  │
│ 8. 改善実施 → プロンプト最適化、パラメータ調整                │
│ 9. 改善後評価 → 同じ条件で再評価                             │
│ 10. 結果比較 → 改善効果の測定、次のアクション決定             │
│ 11. 継続判断 → 目標達成？ Yes → Phase 4 / No → 次の iteration │
└─────────────────────────────────────────────────────────────┘
                            ↓
┌─────────────────────────────────────────────────────────────┐
│ Phase 4: 完了と文書化                                         │
├─────────────────────────────────────────────────────────────┤
│ 12. 最終評価レポート作成 → 改善内容と結果のサマリー           │
│ 13. コードコミット → バージョン管理とドキュメント更新          │
└─────────────────────────────────────────────────────────────┘
```

## 📚 Phase 別詳細ガイド

### [Phase 1: 準備と分析](./workflow_phase1.md)
最適化の方向性を明確にし、改善対象を特定：
- **Step 1**: fine-tune.md の読み込みと理解
- **Step 2**: Serena MCP での最適化対象特定
- **Step 3**: 最適化箇所リストの作成

**所要時間**: 30分-1時間

### [Phase 2: ベースライン評価](./workflow_phase2.md)
現状のパフォーマンスを定量的に測定：
- **Step 4**: 評価環境の準備
- **Step 5**: ベースライン測定（3-5回実行）
- **Step 6**: ベースライン結果の分析

**所要時間**: 1-2時間

### [Phase 3: 反復的改善](./workflow_phase3.md)
データ駆動で段階的にプロンプトを最適化：
- **Step 7**: 優先順位付け
- **Step 8**: 改善実施
- **Step 9**: 改善後評価
- **Step 10**: 結果比較
- **Step 11**: 継続判断

**所要時間**: 各 iteration 1-2時間 × iterations 数（通常 3-5回）

### [Phase 4: 完了と文書化](./workflow_phase4.md)
最終的な成果を記録し、コードをコミット：
- **Step 12**: 最終評価レポート作成
- **Step 13**: コードコミットとドキュメント更新

**所要時間**: 30分-1時間

## 🎯 ワークフロー実行のポイント

### 初めてファインチューニングを実施する場合

1. **Phase 1 から順番に**: 飛ばさずに全 Phase を実施
2. **ドキュメント作成**: 各 Phase の結果を記録
3. **小さく始める**: 最初は少数のテストケースで実験

### 継続的なファインチューニング

1. **Phase 2 から開始**: 新しいベースラインを測定
2. **Phase 3 を繰り返す**: 継続的な改善サイクル
3. **自動化を検討**: 評価パイプラインの構築

## 📊 成功のための原則

1. **データ駆動**: すべての判断を測定結果に基づく
2. **段階的改善**: 1度に1つの変更、測定、検証
3. **文書化**: 各 Phase の結果と学びを記録
4. **統計的検証**: 複数回実行して有意性を確認

## 🔗 関連ドキュメント

- **[実践例集](./examples.md)** - 各 Phase のコード例とテンプレート
- **[評価方法](./evaluation.md)** - 評価指標と統計分析の詳細
- **[プロンプト最適化](./prompt_optimization.md)** - 最適化テクニックの詳細
- **[SKILL.md](./SKILL.md)** - Fine-tune スキル全体の概要

## 💡 トラブルシューティング

### Phase 1 で最適化対象が見つからない
→ [workflow_phase1.md#step-2](./workflow_phase1.md#step-2-serena-mcp-での最適化対象特定) の検索パターンを確認

### Phase 2 で評価スクリプトが実行できない
→ [workflow_phase2.md#step-4](./workflow_phase2.md#step-4-評価環境の準備) のチェックリストを確認

### Phase 3 で改善効果が出ない
→ [workflow_phase3.md#step-7](./workflow_phase3.md#step-7-優先順位付け) の優先順位マトリックスを見直し

### Phase 4 でレポート作成に時間がかかる
→ [workflow_phase4.md#step-12](./workflow_phase4.md#step-12-最終評価レポート作成) のテンプレートを活用

---

このワークフローに従うことで：
- ✅ 体系的なファインチューニングプロセスを実行
- ✅ データ駆動の意思決定
- ✅ 継続的な改善と検証
- ✅ 完全な文書化とトレーサビリティ

が実現できます。
